<div class="container flex">
	<left-nav></left-nav>
	<div class="right-content flex-1">
		<header-nav></header-nav>
		<div class="content admin-inspect-resutls">
			<top-bar [data]="topBar"></top-bar>
			<div class="pure-g left-right-tab">
				<div class="pure-u-1-5 left-tab pr20">
					<div class="img-tab-default">
						<img src="{{bookingInfo.imageUrl}}">
					</div>
					<div class="item">{{bookingInfo.childName}}</div>
				</div>
				<div class="pure-u-4-5 right-tab">
					<div class="second-bar-tab flex">
						<div class="item" (click)="changeTab(check.id)" *ngFor="let check of checkProjectList" [ngClass]="{'active': selectTab == check.id}">{{check.checkName}}</div>
					</div>
					<div *ngFor="let check of checkProjectList; let indexCheck=index;">
						<div *ngIf="selectTab == check.id">
							<div class="pt10 pb10">开单医生：{{check.doctorName}}</div>
							<form #f="ngForm" class="pure-form">
								<table class="pure-table pure-table-horizontal w100 table-tab">
									<thead>
										<tr>
											<th class="w20">项目</th>
											<th class="w10">代码</th>
											<th class="w20">
												<span>检查结果</span>
												<span class="required">*</span>
											</th>
											<th [ngClass]="{'w20': check.editType == 'create', 'w30': check.editType == 'update'}">参考值</th>
											<th class="w10">单位</th>
											<th class="w10">性质</th>
											<!-- 创建时可操作 -->
											<th *ngIf="check.editType == 'create'" class="w10">操作</th>
										</tr>
									</thead>
									<tbody>
										<ng-container *ngFor="let result of check.resultList; let indexResult=index;">
											<tr *ngIf="result.use">
												<td>{{result.checkInfoName}}</td>
												<!-- 文本填写亦或图片上传 -->
												<ng-container *ngIf="result.isUpload == '0'">
													<td>{{result.code}}</td>
													<td>
														<input type="text" name="values_{{indexResult}}" [(ngModel)]="result.values" placeholder="请输入检查结果" [disabled]="buttonType == 'update'" (change)="changeResult(result, indexCheck, indexResult)" class="w100">
													</td>
													<td>
														<div class="length-text">{{result.references}}</div>
													</td>
													<td>{{result.unit}}</td>
													<td class="text-center">
														<i *ngIf="result.compare == 'low'" class="icon-arrow-down" style="color: #458DCB"></i>
														<i *ngIf="result.compare == 'high'" class="icon-arrow-up" style="color: #C92D54"></i>
													</td>
												</ng-container>
												<ng-container *ngIf="result.isUpload == '1'">
													<td>
														<a *ngIf="buttonType != 'update'" class="upload-button-tab">
															<button class="pure-button pure-button-primary">选择图片</button>
															<input type="hidden" id="file_{{result.checkInfoId}}" name="file_{{result.checkInfoId}}" ngModel>
															<input class="upload" type="file" (change)="selectedFile($event, result.checkInfoId)">
														</a>
													</td>
													<td colspan="4">
														<div class="upload-button-tab img">
															<img (click)="enlargeImg($event.target)" id="imgEle_{{result.checkInfoId}}" src="{{result.values ? result.values : '../assets/images/result.png'}}">
														</div>
													</td>
												</ng-container>
												<!-- 创建时可操作 -->
												<td *ngIf="check.editType == 'create'">
													<button (click)="removeItem(indexCheck, indexResult)" class="pure-button pure-button-primary">移除</button>
												</td>
											</tr>
										</ng-container>
									</tbody>
								</table>
								<div *ngIf="check.hasRemoveResult">
									<div class="bg-title mt10 mb10">可选项</div>
									<table class="pure-table pure-table-horizontal w100 table-tab">
										<thead>
											<tr>
												<th class="w50">项目</th>
												<th class="w50">操作</th>
											</tr>
										</thead>
										<tbody>
											<ng-container *ngFor="let result of check.resultList; let indexResult=index;">
												<tr *ngIf="!result.use">
													<td>{{result.checkInfoName}}</td>
													<td>
														<button (click)="addItem(indexCheck, indexResult)" class="pure-button pure-button-primary">添加</button>
													</td>
												</tr>
											</ng-container>
										</tbody>
									</table>
								</div>
								<div class="pure-form pure-form-stacked form-tab">
									<div class="flex">
										<div class="pure-control-group flex-1">
											<label for="remark">备注（最多100字）</label>
											<textarea id="remark" name="remark" maxlength="100" [(ngModel)]="check.remark" placeholder="请输入备注" [disabled]="buttonType == 'update'"></textarea>
										</div>
										<div class="flex-1"></div>
									</div>
								</div>
								<div class="pt20 text-center">
									<button (click)="changeButton(f)" *ngIf="buttonType == 'update'" class="pure-button pure-button-primary button-max">修改</button>
									<button (click)="save(indexCheck)" *ngIf="buttonType == 'save'" class="pure-button pure-button-primary button-max">保存</button>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<modal-toast modalTab="{{toast.show}}" text="{{toast.text}}" type="{{toast.type}}"></modal-toast>
<modal-img url="{{modalImg.url}}" showImg="{{modalImg.showImg}}" (onVoted)="closeImg()"></modal-img>
<loading [show]="loadingShow"></loading>
