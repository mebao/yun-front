<div class="container flex">
	<left-nav></left-nav>
	<div class="right-content flex-1">
		<header-nav></header-nav>
		<div class="content admin-create-booking-page">
			<div class="x_title">预约</div>
			<div class="pure-g">
				<div class="pure-u-1-5"></div>
				<div class="pure-u-3-5">
					<form #f="ngForm" class="pure-form pure-form-stacked">
						<fieldset>
							<!-- <div class="pure-control-group">
								<label for="type">预约类型</label>
								<select id="type" name="type" [(ngModel)]="bookingInfo.type" #type="ngModel" (change)="typeChange($event.target.value)" required="">
									<option value="PT">普通号</option>
									<option value="ZJ">专家号</option>
								</select>
								<div *ngIf="type.errors && (type.dity || type.touched)" class="alert alert-danger">
									<div [hidden]="!type.errors.required">
										预约类型不可为空
									</div>
								</div>
							</div> -->
							<div class="pure-control-group">
								<label for="service">预约科室</label>
								<select id="service" name="service" (change)="serviceChange($event.target.value)" [(ngModel)]="bookingInfo.service" #service="ngModel" required="">
									<ng-container *ngFor="let service of servicelist">
										<option value="{{service.string}}">{{service.serviceName}}</option>
									</ng-container>
								</select>
								<div *ngIf="service.errors && (service.dity || service.touched)" class="alert alert-danger">
									<div [hidden]="!service.errors.required">
										服务不可为空
									</div>
								</div>
							</div>
							<div class="pure-control-group" *ngIf="bookingInfo.type == 'PT'">
								<label for="booking_date">预约日期</label>
								<select id="booking_date" name="booking_date" [(ngModel)]="bookingInfo.booking_date" #booking_date="ngModel" (change)="dateChange()" required="">
									<ng-container *ngFor="let date of doctorDutys">
										<option *ngIf="date.use" value="{{date.string}}">{{date.dutyDate}}{{date.weekDay}}</option>
										<option *ngIf="!date.use" value="{{date.string}}" disabled="">{{date.dutyDate}}{{date.weekDay}}</option>
									</ng-container>
								</select>
								<div *ngIf="booking_date.errors && (booking_date.dity || booking_date.touched)" class="alert alert-danger">
									<div [hidden]="!booking_date.errors.required">
										预约日期不可为空
									</div>
								</div>
							</div>
							<div class="pure-control-group" *ngIf="bookingInfo.type == 'PT'">
								<label for="time">预约时间段</label>
								<select id="time" name="time" [(ngModel)]="bookingInfo.timeInfo" #timeInfo="ngModel" required="">
									<ng-container *ngFor="let time of timelist">
										<option value="{{time.value}}" *ngIf="time.use">{{time.value}}</option>
										<option value="{{time.value}}" *ngIf="!time.use" disabled="">{{time.value}}已预约</option>
									</ng-container>
								</select>
								<div *ngIf="timeInfo.errors && (timeInfo.dity || timeInfo.touched)" class="alert alert-danger">
									<div [hidden]="!timeInfo.errors.required">
										预约时间段不可为空
									</div>
								</div>
							</div>
							<div class="pure-control-group" *ngIf="bookingInfo.type == 'ZJ'">
								<label for="user_doctor">预约医生</label>
								<select id="user_doctor" name="user_doctor" [(ngModel)]="bookingInfo.user_doctor" #user_doctor="ngModel" (change)="doctorChange()" required="">
									<ng-container *ngFor="let doctor of doctorlist">
										<option value="{{doctor.string}}">{{doctor.doctorName}}</option>
									</ng-container>
								</select>
								<div *ngIf="user_doctor.errors && (user_doctor.dity || user_doctor.touched)" class="alert alert-danger">
									<div [hidden]="!user_doctor.errors.required">
										预约医生不可为空
									</div>
								</div>
							</div>
							<div class="pure-control-group" *ngIf="bookingInfo.type == 'ZJ'">
								<label for="booking_date">预约日期</label>
								<select id="booking_date" name="booking_date" [(ngModel)]="bookingInfo.booking_date" #booking_date="ngModel" (change)="dateChange()" required="">
									<ng-container *ngFor="let date of doctorDutys">
										<option value="{{date.string}}">{{date.dutyDate}}{{date.weekDay}}</option>
									</ng-container>
								</select>
								<div *ngIf="booking_date.errors && (booking_date.dity || booking_date.touched)" class="alert alert-danger">
									<div [hidden]="!booking_date.errors.required">
										预约日期不可为空
									</div>
								</div>
							</div>
							<div class="pure-control-group" *ngIf="bookingInfo.type == 'ZJ'">
								<label for="time">预约时间段</label>
								<select id="time" name="time" [(ngModel)]="bookingInfo.timeInfo" #timeInfo="ngModel" required="">
									<ng-container *ngFor="let time of timelist">
										<option value="{{time.value}}" *ngIf="time.use">{{time.value}}</option>
										<option value="{{time.value}}" *ngIf="!time.use" disabled="">{{time.value}}{{time.type}}</option>
									</ng-container>
								</select>
								<div *ngIf="timeInfo.errors && (timeInfo.dity || timeInfo.touched)" class="alert alert-danger">
									<div [hidden]="!timeInfo.errors.required">
										预约时间段不可为空
									</div>
								</div>
							</div>
							<div *ngIf="editType != 'update'" class="pure-control-group">
								<label for="creator">预约用户</label>
								<select id="creator" name="creator" (change)="creatorChange($event.target.value)" [(ngModel)]="bookingInfo.creator" #creator="ngModel" required="">
									<ng-container *ngFor="let user of users">
										<option value="{{user.string}}">{{user.name}}</option>
									</ng-container>
								</select>
								<div *ngIf="creator.errors && (creator.dity || creator.touched)" class="alert alert-danger">
									<div [hidden]="!creator.errors.required">
										预约用户不可为空
									</div>
								</div>
							</div>
							<div *ngIf="editType == 'update'" class="pure-control-group">
								<label for="creator">预约用户</label>
								<select id="creator" name="creator" (change)="creatorChange($event.target.value)" [(ngModel)]="bookingInfo.creator" #creator="ngModel" required="" disabled="">
									<ng-container *ngFor="let user of users">
										<option value="{{user.string}}">{{user.name}}</option>
									</ng-container>
								</select>
								<div *ngIf="creator.errors && (creator.dity || creator.touched)" class="alert alert-danger">
									<div [hidden]="!creator.errors.required">
										预约用户不可为空
									</div>
								</div>
							</div>
							<div *ngIf="editType != 'update' && showChildTab && childs.length > 0">
								<div class="pure-control-group">
									<label for="child">小孩</label>
									<select id="child" name="child" [(ngModel)]="bookingInfo.child" #child="ngModel" required="">
										<ng-container *ngFor="let child of childs">
											<option value="{{child.string}}">{{child.childName}}</option>
										</ng-container>
									</select>
									<div *ngIf="child.errors && (child.dity || child.touched)" class="alert alert-danger">
										<div [hidden]="!child.errors.required">
											小孩不可为空
										</div>
									</div>
								</div>
							</div>
							<div *ngIf="editType == 'update' && showChildTab && childs.length > 0">
								<div class="pure-control-group">
									<label for="child">小孩</label>
									<select id="child" name="child" [(ngModel)]="bookingInfo.child" #child="ngModel" required="" disabled="">
										<ng-container *ngFor="let child of childs">
											<option value="{{child.string}}">{{child.childName}}</option>
										</ng-container>
									</select>
									<div *ngIf="child.errors && (child.dity || child.touched)" class="alert alert-danger">
										<div [hidden]="!child.errors.required">
											小孩不可为空
										</div>
									</div>
								</div>
							</div>
							<div *ngIf="showChildTab && childs.length == 0">
								<div class="pure-control-group">
									<label for="child_name">小孩姓名</label>
									<input id="child_name" type="text" [(ngModel)]="bookingInfo.child_name" #child_name="ngModel" name="child_name" placeholder="请输入小孩姓名" required="">
									<div *ngIf="child_name.errors && (child_name.dity || child_name.touched)" class="alert alert-danger">
										<div [hidden]="!child_name.errors.required">
											小孩姓名不可为空
										</div>
									</div>
								</div>
								<div class="pure-control-group">
									<label for="gender">性别</label>
									<select id="gender" name="gender" [(ngModel)]="bookingInfo.gender" #gender="ngModel" required="">
										<option value="M">男</option>
										<option value="F">女</option>
									</select>
									<div *ngIf="gender.errors && (gender.dity || gender.touched)" class="alert alert-danger">
										<div [hidden]="!gender.errors.required">
											性别不可为空
										</div>
									</div>
								</div>
								<div class="pure-control-group">
									<label for="birth_date">出生年月</label>
									<input id="birth_date" type="date" [(ngModel)]="bookingInfo.birth_date" #birth_date="ngModel" name="birth_date" required="">
									<div *ngIf="birth_date.errors && (birth_date.dity || birth_date.touched)" class="alert alert-danger">
										<div [hidden]="!birth_date.errors.required">
											出生年月不可为空
										</div>
									</div>
								</div>
							</div>
						</fieldset>
						<div class="text-center">
							<button *ngIf="editType == 'update'" (click)="cancalUpdate()" class="pure-button">取消修改</button>
							<button (click)="create(f)" class="pure-button pure-button-primary">{{editType == 'create' ? '创建' : '保存修改'}}</button>
						</div>
					</form>
				</div>
				<div class="pure-u-1-5"></div>
			</div>
		</div>
	</div>
</div>
<modal-toast modalTab="{{toast.show}}" text="{{toast.text}}" type="{{toast.type}}"></modal-toast>