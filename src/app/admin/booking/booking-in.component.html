<div class="container flex">
	<left-nav></left-nav>
	<div class="right-content flex-1">
		<header-nav></header-nav>
		<div class="content admin-booking-in">
			<top-bar [data]="topBar"></top-bar>
			<div class="button-tab">
				<button (click)="todayBooking()" class="pure-button pure-button-primary">今日预约</button>
			</div>
			<form #f="ngForm" class="pure-form pure-form-stacked form-tab">
				<fieldset>
					<div class="pure-g">
						<div class="pure-u-8-24 pr10">
							<div class="pure-control-group">
								<label for="service">预约科室</label>
								<select id="service" name="service" (change)="serviceChange($event.target.value)" [(ngModel)]="bookingInfo.service" #service="ngModel" required="" [disabled]="booking.refNo ==''">
									<ng-container *ngFor="let service of servicelist">
										<option value="{{service.string}}">{{service.serviceName}}</option>
									</ng-container>
								</select>
								<div *ngIf="service.errors && (service.dity || service.touched)" class="alert alert-danger">
									<div [hidden]="!service.errors.required">
										服务不可为空
									</div>
								</div>
							</div>
						</div>
						<div class="pure-u-8-24 pl5 pr5">
							<div class="pure-control-group">
								<label for="user_doctor">预约医生</label>
								<select id="user_doctor" name="user_doctor" [(ngModel)]="bookingInfo.user_doctor" #user_doctor="ngModel" (change)="doctorChange()" required="" [disabled]="booking.refNo ==''">
									<ng-container *ngFor="let doctor of doctorlist">
										<option value="{{doctor.string}}">{{doctor.doctorName}}</option>
									</ng-container>
								</select>
								<div *ngIf="user_doctor.errors && (user_doctor.dity || user_doctor.touched)" class="alert alert-danger">
									<div [hidden]="!user_doctor.errors.required">
										预约医生不可为空
									</div>
								</div>
							</div>
						</div>
						<div class="pure-u-8-24 pl10">
							<div class="pure-control-group">
								<label for="booking_date">预约日期</label>
								<select id="booking_date" name="booking_date" [(ngModel)]="bookingInfo.booking_date" #booking_date="ngModel" (change)="dateChange()" required="" [disabled]="booking.refNo ==''">
									<ng-container *ngFor="let date of doctorDutys">
										<option value="{{date.string}}">{{date.dutyDate}}{{date.weekDay}}</option>
									</ng-container>
								</select>
								<div *ngIf="booking_date.errors && (booking_date.dity || booking_date.touched)" class="alert alert-danger">
									<div [hidden]="!booking_date.errors.required">
										预约日期不可为空
									</div>
								</div>
							</div>
						</div>
						<div class="pure-u-8-24 pr10">
							<div class="pure-control-group">
								<label for="time">预约时间段</label>
								<select id="time" name="time" [(ngModel)]="bookingInfo.timeInfo" #timeInfo="ngModel" required="" [disabled]="booking.refNo ==''">
									<ng-container *ngFor="let time of timelist">
										<option value="{{time.value}}" *ngIf="time.use">{{time.value}}</option>
										<option value="{{time.value}}" *ngIf="!time.use" disabled="">{{time.value}}{{time.type}}</option>
									</ng-container>
								</select>
								<div *ngIf="timeInfo.errors && (timeInfo.dity || timeInfo.touched)" class="alert alert-danger">
									<div [hidden]="!timeInfo.errors.required">
										预约时间段不可为空
									</div>
								</div>
							</div>
						</div>
						<div class="pure-u-8-24 pl5 pr5">
							<div class="pure-control-group">
								<label for="creator">预约用户</label>
								<select id="creator" name="creator" disabled="">
									<option value="">{{booking.creatorName}}</option>
								</select>
							</div>
						</div>
						<div class="pure-u-8-24 pl10">
							<div class="pure-control-group">
								<label for="child">小孩</label>
								<select id="child" name="child" disabled="">
									<option value="">{{booking.childName}}</option>
								</select>
							</div>
						</div>
					</div>
				</fieldset>	
				<div class="text-center">
					<button (click)="bookingIn(f)" [disabled]="booking.refNo ==''"	 class="pure-button pure-button-primary">登记</button>
				</div>
			</form>
		</div>
	</div>
</div>
<div class="modal" *ngIf="modalTab">
	<div class="modal-mask" (click)="close()"></div>
	<div class="container">
		<div class="title">今日预约</div>
		<div class="content pad10">
			<div class="pure-g pt10 pb10">
				<div class="pure-u-1-5">姓名</div>
				<div class="pure-u-1-5">年龄</div>
				<div class="pure-u-1-5">预约医生</div>
				<div class="pure-u-1-5">预约服务</div>
				<div class="pure-u-1-5">预约时间</div>
			</div>
			<div class="list">
				<div class="pure-g item pt10 pb10" (click)="show(booking)" *ngFor="let booking of bookinglist">
					<div class="pure-u-1-5">{{booking.childName}}</div>
					<div class="pure-u-1-5">{{booking.age}}</div>
					<div class="pure-u-1-5">{{booking.services[0].userDoctorName}}</div>
					<div class="pure-u-1-5">{{booking.services[0].serviceName}}</div>
					<div class="pure-u-1-5">
						<span>{{booking.bookingDate}}</span>
						<span>{{booking.time}}</span>
					</div>
				</div>
			</div>
		</div>
		<div class="button-tab pad10 text-right">
			<button (click)="close()" class="pure-button pure-button-primary">取消</button>
		</div>
	</div>
</div>
<modal-toast modalTab="{{toast.show}}" text="{{toast.text}}" type="{{toast.type}}"></modal-toast>