<!-- <header-nav></header-nav> -->
<div class="content-section admin-booking-charge">
	<top-bar [data]="topBar"></top-bar>
	<div nz-row [nzGutter]="30" class="mt10">
		<div nz-col [nzSpan]="8">
			<div nz-form-item nz-row>
				<div nz-form-label nz-col [nzSpan]="10" class="text-right">
					<label>医生：</label>
				</div>
				<div nz-form-control nz-col [nzSpan]="14">
					<nz-select
						class="w100"
						nzAllowClear
						[nzSize]="'large'"
						[nzPlaceHolder]="'请选择医生'"
						[(ngModel)]="searchInfo.doctor_id"
						nzShowSearch>
						<nz-option
							*ngFor="let doctor of doctorlist"
							[nzLabel]="doctor.realName"
							[nzValue]="doctor.id">
						</nz-option>
					</nz-select>
				</div>
			</div>
		</div>
		<div nz-col [nzSpan]="8">
			<div nz-form-item nz-row>
				<div nz-form-label nz-col [nzSpan]="10" class="text-right">
					<label>科室：</label>
				</div>
				<div nz-form-control nz-col [nzSpan]="14">
					<nz-select
						class="w100"
						nzAllowClear
						[nzSize]="'large'"
						[nzPlaceHolder]="'请选择科室'"
						[(ngModel)]="searchInfo.service_id"
						nzShowSearch>
						<nz-option
							*ngFor="let service of servicelist"
							[nzLabel]="service.serviceName"
							[nzValue]="service.serviceId">
						</nz-option>
					</nz-select>
				</div>
			</div>
		</div>
		<div nz-col [nzSpan]="8">
			<div nz-form-item nz-row>
				<div nz-form-label nz-col [nzSpan]="10" class="text-right">
					<label>宝宝姓名：</label>
				</div>
				<div nz-form-control nz-col [nzSpan]="14">
					<nz-input [(ngModel)]="searchInfo.child_name" [nzPlaceHolder]="'请输入宝宝姓名'" [nzSize]="'large'"></nz-input>
				</div>
			</div>
		</div>
	</div>
	<div nz-row [nzGutter]="30" class="mt10">
		<div nz-col [nzSpan]="8">
			<div nz-form-item nz-row>
				<div nz-form-label nz-col [nzSpan]="10" class="text-right">
					<label>创建时间：</label>
				</div>
				<div nz-form-control nz-col [nzSpan]="14">
					<nz-rangepicker [(ngModel)]="searchInfo.cdate" [nzSize]="'large'" [nzPlaceholder]="['请选择开始日期', '请选择结束日期']"></nz-rangepicker>
				</div>
			</div>
		</div>
		<div nz-col [nzSpan]="8">
			<div nz-form-item nz-row>
				<div nz-form-label nz-col [nzSpan]="10" class="text-right">
					<label>预约时间：</label>
				</div>
				<div nz-form-control nz-col [nzSpan]="14">
					<nz-rangepicker [(ngModel)]="searchInfo.bdate" [nzSize]="'large'" [nzPlaceholder]="['请选择开始日期', '请选择结束日期']"></nz-rangepicker>
				</div>
			</div>
		</div>
		<!-- <div nz-col [nzSpan]="8">
			<div nz-form-item nz-row>
				<div nz-form-label nz-col [nzSpan]="10" class="text-right">
					<label>手机号码：</label>
				</div>
				<div nz-form-control nz-col [nzSpan]="14">
					<nz-input [nzType]="'tel'" [(ngModel)]="searchInfo.mobile" maxlength="11" [nzPlaceHolder]="'请输入手机号码'" [nzSize]="'large'"></nz-input>
				</div>
			</div>
		</div> -->
	</div>
	<div class="text-right mt10 mb10">
		<button (click)="search()" nz-button [nzType]="'primary'" [nzSize]="'large'">搜索</button>
	</div>
	
	<div *ngIf="hasData && bookinglist.length > 0" class="mt10">
		<nz-alert [nzType]="'info'" [nzMessage]="'共查询到预约' + bookinglist.length + '条'"></nz-alert>
	</div>
	<div nz-row [nzGutter]="30">
		<div nz-col [nzSpan]="8" class="booking-tab pad10" *ngFor="let booking of bookinglist">
			<nz-tooltip>
				<div nz-tooltip class="tab" [ngClass]="{'complete': booking.status == '5', 'in': booking.status == '11'}">
					<div class="info pad10" [ngClass]="{'active': booking.memberId != null}">
						<img *ngIf="booking.memberId != null" class="vip-icon" src="../assets/images/{{booking.memberName.indexOf('太阳') != -1 ? 'icon_son.png' : booking.memberName.indexOf('月亮') != -1 ? 'icon_moon.png' : booking.memberName.indexOf('星星') != -1 ? 'icon_star.png' : 'vip.png'}}" />
						<div class="flex">
							<div class="flex-1"></div>
							<div class="status">
								{{booking.statusText}}
							</div>
						</div>
						<p>宝宝姓名：{{booking.childName}}</p>
						<p>宝宝年龄：{{booking.age}}</p>
						<p>预约科室：{{booking.serviceName}}</p>
						<p>预约日期：{{booking.bookingDate}}</p>
						<p>预约时间：{{booking.time}}</p>
						<p>预约医生：{{booking.userDoctorName}}</p>
					</div>
					<div class="flex">
						<a *ngIf="moduleAuthority.payment && (booking.status == '11' || booking.status == '5')" class="edit pay flex-1 pad10 text-center" (click)="payment(booking)">
							收费
						</a>
					</div>
				</div>
				<ng-template #nzTemplate>
					<div>{{booking.memberName}}（{{booking.userBalance ? booking.userBalance : '0.00'}}元）</div>
					<div *ngFor="let actcard of booking.actCards">
						{{actcard.activityName}}（剩余：{{actcard.num}}次）
					</div>
		      	</ng-template>
			</nz-tooltip>
		</div>
	</div>
	<div *ngIf="hasData && bookinglist.length == 0">
		<nz-alert [nzType]="'info'" [nzMessage]="'未查询到收费信息'"></nz-alert>
	</div>
</div>
<loading [show]="loadingShow"></loading>
