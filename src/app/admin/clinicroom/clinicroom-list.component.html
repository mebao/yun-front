<div class="container flex">
	<left-nav></left-nav>
	<div class="right-content flex-1">
		<header-nav></header-nav>
		<div class="content admin-clinicroom-list">
			<div class="x_title">诊室列表</div>
			<div class="button-tab">
				<button (click)="goCreate()" class="pure-button pure-button-primary">新增诊室</button>
				<button (click)="goRecords()" class="pure-button pure-button-primary">诊室使用记录</button>
			</div>
			<div class="">
				<table *ngIf="conditions.length > 0" class="pure-table pure-table-horizontal w100 mt10">
					<thead>
						<tr>
							<th>诊室名称</th>
							<th>诊室类型</th>
							<th>诊室编号</th>
							<th>坐诊专家</th>
							<th>就诊用户</th>
							<th>就诊小孩</th>
							<th>使用情况</th>
							<th>分配专家</th>
							<th>分配患者</th>
							<th>修改状态</th>
							<th>坐诊专家</th>
							<th>修改诊室信息</th>
						</tr>
					</thead>
					<tbody>
						<tr class="pure-form" *ngFor="let condition of conditions">
							<td>{{condition.name}}</td>
							<td>{{condition.typeText}}</td>
							<td>{{condition.roomNo}}</td>
							<td>{{condition.doctorName}}</td>
							<td>{{condition.userName}}</td>
							<td>{{condition.childName}}</td>
							<td>{{condition.canUse == 1 ? '未使用' : '使用中...'}}</td>
							<td *ngIf="!(condition.doctorName && condition.doctorId)">
								<select name="doctor_{{condition.id}}" ngModel (change)="doctorChange($event.target.value, condition.id)">
									<ng-container *ngFor="let doctor of doctorlist">
										<option *ngIf="!doctor.use" disabled="" value="{{doctor.string}}">
											<span class="mr10">{{doctor.realName}}</span>
											<span>(就诊中...)</span>
										</option>
										<option *ngIf="doctor.use" value="{{doctor.string}}">{{doctor.realName}}</option>
									</ng-container>
								</select>
							</td>
							<td *ngIf="condition.doctorName && condition.doctorId">-</td>
							<td *ngIf="!(condition.userName && condition.childName)">
								<select name="booking_{{condition.id}}" ngModel (change)="bookingChange($event.target.value, condition.doctorId, condition.id)">
									<ng-container *ngFor="let booking of bookinglist">
										<option value="{{booking.string}}">{{booking.creatorName}}-{{booking.childName}}</option>
									</ng-container>
								</select>
							</td>
							<td *ngIf="condition.userName && condition.childName">-</td>
							<td *ngIf="condition.canUse != 1">
								<button (click)="updateStatus(condition.id)" class="pure-button pure-button-primary">诊室使用结束</button>
							</td>
							<td *ngIf="condition.canUse == 1">-</td>
							<td *ngIf="condition.canUse == 1 && condition.doctorName && condition.doctorId">
								<button (click)="removeroomdoctor(condition.id)" class="pure-button pure-button-primary">就诊结束</button>
							</td>
							<td *ngIf="condition.canUse != 1 || !(condition.doctorName && condition.doctorId)">-</td>
							<td>
								<span *ngIf="condition.userName && condition.childName">-</span>
								<button *ngIf="!(condition.userName && condition.childName)" (click)="updateClinicroom(condition.id)" class="pure-button pure-button-primary">修改</button>
							</td>
						</tr>
					</tbody>
				</table>
				<div *ngIf="hasData && conditions.length == 0" class="mt10">
					<nodata title="未查询到诊室信息"></nodata>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="modal" *ngIf="modalConfirmTab">
	<div class="modal-mask" (click)="closeConfirm()"></div>
	<div class="container">
		<div class="title">待确认</div>
		<div class="content pad10">
			{{confirmText}}
		</div>
		<div class="button-tab pad10 text-right">
			<button (click)="closeConfirm()" class="pure-button pure-button-primary">关闭</button>
			<button (click)="confirm()" class="pure-button pure-button-primary">确认</button>
		</div>
	</div>
</div>
<modal-toast modalTab="{{toast.show}}" text="{{toast.text}}" type="{{toast.type}}"></modal-toast>